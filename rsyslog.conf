##################
# Modules
##################
module(load="imudp")     # For UDP
module(load="imtcp")     # For TCP
module(load="gtls")      # For TLS via GnuTLS

##################
# Global TLS settings
##################
global(
  DefaultNetstreamDriver="gtls"
)

##################
# UDP input on port 514
##################
input(
  type="imudp"
  port="514"
  ruleset="udp_rules"
)

##################
# TCP input on port 6514 with TLS
##################
ruleset(name="tcp_tls_rules") {
  *.* /var/log/tcp_tls.log
}

input(
  type="imtcp"
  port="6514"
  StreamDriverMode="1"         # TLS only
  StreamDriverAuthMode="anon"  # No certs
  ruleset="tcp_tls_rules"
)

##################
# UDP ruleset â†’ logs to different file
##################
ruleset(name="udp_rules") {
  *.* /var/log/udp.log
}